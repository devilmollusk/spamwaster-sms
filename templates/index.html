<!doctype html>
<html>
  <head>
    <title>Log Stream</title>
    <style>
      body {
        font-family: monospace;
      }
      #log {
        white-space: pre-wrap; /* Preserve formatting and line breaks */
        overflow-y: auto; /* Scrollable area if log is long */
        height: 80vh; /* Adjust height as needed */
      }
    </style>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <script type="text/javascript">
      document.addEventListener("DOMContentLoaded", function() {
        const socket = io.connect('http://' + document.domain + ':' + location.port);
        const log = document.getElementById("log");

        // Append initial content
        log.innerHTML = JSON.parse("{{ initial_content | safe }}");
        log.scrollTop = log.scrollHeight; // Scroll to the bottom on initial load
        // Handle log updates from the server
        socket.on('log_update', function(data) {
          log.innerHTML += data;
          log.scrollTop = log.scrollHeight; // Scroll to the bottom
        });
      });
    </script>
  </head>
  <body>
    <h1>Log Stream</h1>
    <div id="log"></div>
  </body>
</html>
