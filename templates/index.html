<!doctype html>
<html>
  <head>
    <title>Log Stream</title>
    <script type="text/javascript">
      function fetchLogs() {
        const eventSource = new EventSource("/stream");
        eventSource.onmessage = function(event) {
          const log = document.getElementById("log");
          const newElement = document.createElement("div");
          newElement.innerHTML = event.data.replace(/\\n/g, '<br>');
          log.appendChild(newElement);
        };
      }

      document.addEventListener("DOMContentLoaded", function() {
        // Set initial content
        const initialContent = document.getElementById("log").innerHTML;
        const log = document.getElementById("log");
        log.innerHTML = initialContent;

        fetchLogs(); // Start fetching logs after initial content is loaded
      });
    </script>
  </head>
  <body>
    <h1>Log Stream</h1>
    <div id="log">{{ initial_content | safe }}</div>
  </body>
</html>
